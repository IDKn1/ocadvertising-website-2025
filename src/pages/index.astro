---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import NavBar from '../components/NavBar.astro';

const grads = (await getCollection('grads')).sort((a, b) =>
  a.data.lastName.localeCompare(b.data.lastName)
);
---

<BaseLayout title="Meet Our 2025 Grads">
    <NavBar />

    <section class="hero">
      <div class="headline">
        <div>Meet</div>
        <div>Our</div>
        <div>2025</div>
        <div>Grads</div>
      </div>
    </section>

    <section class="filter">
      {[
        "Creative Director", "Art Director", "Copywriter",
        "Strategist", "Brand Designer", "Designer", "Artist"
      ].map(role => (
        <button type="button" data-role={role} onClick={`toggleFilter('${role}')`}>
          {role}
        </button>
      ))}
    </section>

    <section class="profiles">
      {grads.map(({ data, slug }) => (
        <div
    class="profile"
    style={`background-color: ${data.color};`}
    data-roles={data.role.join('/')}
  >
        <a href={`/grads/${slug}`} style="text-decoration: none; color: inherit;">
    <img src={data.image} alt={`${data.firstName} ${data.lastName}`} />
    <div style="display: flex; justify-content: space-between; align-items:baseline;">
      <h3>{data.firstName} {data.lastName}</h3>
      <p>{data.role.join(' / ')}</p>
    </div>
    <blockquote>"{data.quote}"</blockquote>
</a>
  </div>

))}

    </section>

    <footer class="footer">
      &copy; 2025 Your School Name. All rights reserved.
    </footer>

    <script>
      function toggleFilter(role) {
        const activeFilters = new Set(
          JSON.parse(localStorage.getItem('filters') || '[]')
        );
        if (activeFilters.has(role)) {
          activeFilters.delete(role);
        } else {
          activeFilters.add(role);
        }
        localStorage.setItem('filters', JSON.stringify([...activeFilters]));
        document.querySelectorAll('.profile').forEach(card => {
          const roles = card.dataset.roles.split(',');
          const match = [...activeFilters].every(f => roles.includes(f));
          card.style.display = activeFilters.size === 0 || match ? '' : 'none';
        });
        document.querySelectorAll('.filter button').forEach(btn => {
          btn.classList.toggle('active', activeFilters.has(btn.dataset.role));
        });
      }

      window.addEventListener('DOMContentLoaded', () => {
        const filters = JSON.parse(localStorage.getItem('filters') || '[]');
        filters.forEach(role => toggleFilter(role));
      });
    </script>
  <script type="module" src="/scripts/filter.js"></script>
</BaseLayout>
